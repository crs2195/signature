iTEXT PDF is a SDK offered under the AGPL license for generating, programming and manipulating PDF documents, and is available for both Java and .NET frameworks. In order to interact with iText 7 with an existing PDF document for the purpose of signing it, PdfReader and PdfSigner objects are required to extract the bits of the document and to define the signature details, with a specialized PDFSignatureAppearance class. The signature request is made from the SignDetached method, from the PdfSigner class, that signs the document using the detached, CMS or CadES equivalent mode. The most important parameter of the method is an iTextSignature object, which implements the IExternalSignature interface, and overrides its methods (Sign, GetEncryptionAlgorithm, GetSigningAlgorithm). Also, the list of X509Certificate (Bouncy Castle class) certificates is required and the type of signature. The method can also receive a certificate revocation list (CRL), an Online Certificate Status Protocol (OCSP) client and a timestamp client. The overwritten methods are executed without their explicit call, but implicitly by the SDK, within the SignDetached method. The Sign method requests the signature bytes from the remote digital signature web service exposed by the TSP, then returns them, in order to be added to the reserved space for the signature, in the SignDetached method. The computation of a remote digital signature for a PDF document is also possible using the 5th version of iText, which has some different classes, but the implementation is similar.
